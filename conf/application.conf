# https://www.playframework.com/documentation/latest/Configuration
play.http.secret.key="changeme"

slick.dbs {
  default {
    profile = "clickhouse.ClickHouseProfile$"
    db {
      driver = "ru.yandex.clickhouse.ClickHouseDriver"
      url = "jdbc:clickhouse://127.0.0.1:8123"
      numThreads = 4
      queueSize = 128
      maxConnections = 4
    }
  }
}

ot {
  clickhouse {
    target {
      associations {
        label = "Association table for targets"
        name = "ot.associations_otf_right"
        key = "target_id"
      }

      networks = [
        {label = "Experimental P2P interaction network", name = "ot.target_network_t", key = "target_id", field = "neighbours"},
        {label = "String P2P interaction network", name = "ot.target_network_stringdb_t", key = "target_id", field = "neighbours"}
      ]
    }

    disease {
      associations {
        label = "Association table for targets"
        name = "ot.associations_otf_left"
        key = "disease_id"
      }

      networks = [
        {label = "EFO Ontology v2",name = "ot.disease_network_t", key = "disease_id", field = "neighbours"}
      ]
    }

    harmonic {
      pExponent = 2
      datasources = [
        {id: "cancer_gene_census", weight = 1, data-type = "somatic_mutation", propagate = true},
        {id: "chembl", weight = 1, data-type = "known_drug", propagate = true},
        {id: "crispr", weight: 1, data-type = "affected_pathway", propagate = true},
        {id: "europepmc", weight: 0.2, data-type = "literature", propagate = true},
        {id: "eva", weight: 1, data-type = "genetic_association", propagate = true},
        {id: "eva_somatic", weight: 1, data-type = "somatic_mutation", propagate = true},
        {id: "expression_atlas", weight: 0.2, data-type = "rna_expression", propagate = false},
        {id: "gene2phenotype", weight: 1, data-type = "genetic_association", propagate = true},
        {id: "genomics_england", weight: 1, data-type = "genetic_association", propagate = true},
        {id: "ot_genetics_portal", weight: 1, data-type = "genetic_association", propagate = true},
        {id: "intogen", weight: 1, data-type = "somatic_mutation", propagate = true},
        {id: "phenodigm", weight: 0.2, data-type = "animal_model", propagate = true},
        {id: "phewas_catalog", weight: 1, data-type = "genetic_association", propagate = true},
        {id: "progeny", weight: 0.5, data-type = "affected_pathway", propagate = true},
        {id: "reactome", weight: 1, data-type = "affected_pathway", propagate = true},
        {id: "slapenrich", weight: 0.5, data-type = "affected_pathway", propagate = true},
        {id: "sysbio", weight: 0.5, data-type = "affected_pathway", propagate = true},
        {id: "uniprot", weight: 1, data-type = "genetic_association", propagate = true},
        {id: "uniprot_literature", weight: 1, data-type = "genetic_association", propagate = true},
        {id: "uniprot_somatic", weight: 1, data-type = "somatic_mutation", propagate = true}
      ]
    }
  }

  elasticsearch {
    host = "localhost"
    port = 9200
    entities = [
      {
        name = "evidences_aotf"
        index = "evidences_aotf"
      },
      {
        name = "evidence_drug_direct"
        index = "evidence_drug_direct"
      },
      {
        name = "disease_relation"
        index = "disease_relation"
      },
      {
        name = "otar_projects"
        index = "otar_projects"
      },
      {
        name = "target_relation"
        index = "target_relation"
      },
      {
        name = "faers"
        index = "openfda_faers"
      },
      {
        name = "mp"
        index = "mouse_phenotypes"
      },
      {
        name = "eco"
        index = "eco"
      },
      {
        name = "expression"
        index = "expression"
      },
      {
        name = "reactome"
        index = "reactome"
      },
      {
        name = "cancerBiomarker"
        index = "cancerbiomarker"
      },
      {
        name = "target"
        index = "target"
        searchIndex = "search_target"
      },
      {
        name = "disease"
        index = "disease"
        searchIndex = "search_disease"
      },
      {
        name = "drug"
        index = "drug"
        searchIndex = "search_drug"
      }
    ]
    highlightFields = [
      "id",
      "keywords",
      "name",
      "description",
      "prefixes",
      "terms",
      "terms5",
      "terms25",
      "ngrams"
    ]
  }

  meta {
    name = "Open Targets GraphQL & REST API Beta"
    apiVersion {
      x = 0
      y = 41
      z = 0
    }
    dataVersion {
      year = 20
      month = 06
      iteration = 0
    }
  }
}

play.filters.disabled += play.filters.csrf.CSRFFilter
play.filters.disabled += play.filters.headers.SecurityHeadersFilter
play.filters.disabled += play.filters.csp.CSPFilter
play.filters.enabled += play.filters.hosts.AllowedHostsFilter
play.filters.enabled += play.filters.cors.CORSFilter

play {
  server {
    akka {
      max-header-value-length = 16k
    }
  }

  filters {
    hosts {

      # A list of valid hosts (e.g. "example.com") or suffixes of valid hosts (e.g. ".example.com")
      # Note that ".example.com" will match example.com and any subdomain of example.com, with or without a trailing dot.
      # "." matches all domains, and "" matches an empty or nonexistent host.
      allowed = ["."]
    }
    cors {
      pathPrefixes = ["/"]
      supportsCredentials = false
    }
    # GZip filter configuration
    gzip {

      # The buffer size to use for gzipped bytes
      bufferSize = 8k

      # The maximum amount of content to buffer for gzipping in order to calculate the content length before falling back
      # to chunked encoding.
      chunkedThreshold = 100k

      contentType {

        # If non empty, then a response will only be compressed if its content type is in this list.
        whiteList = []

        # The black list is only used if the white list is empty.
        # Compress all responses except the ones whose content type is in this list.
        blackList = []
      }
    }
  }
}

akka.http {
  parsing {
    max-uri-length = 16k
  }
}
